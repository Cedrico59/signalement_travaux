<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Signalement de travaux ‚Äî Marcq-en-Bar≈ìul ‚Äî Carte</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b1020">

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />

  <style>
    :root { --bg:#0b1020; --panel:#111a33; --muted:#9db0ff; --text:#eef1ff; --line:#20305f; --accent:#6aa6ff; --danger:#ff6b6b; }
    * { box-sizing:border-box; }
    html, body { height:100%; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; background:var(--bg); color:var(--text); }
    header { padding:14px 16px; border-bottom:1px solid var(--line); display:flex; align-items:center; justify-content:space-between; gap:12px; }
    header h1 { margin:0; font-size:16px; font-weight:800; letter-spacing:.2px; }
    header .badge { font-size:12px; color:var(--muted); border:1px solid var(--line); padding:4px 8px; border-radius:999px; }

    main { display:grid; grid-template-columns: 1.35fr .65fr; height: calc(100vh - 56px); }
    #map { height:100%; width:100%; }
    aside { border-left:1px solid var(--line); background: linear-gradient(180deg, rgba(17,26,51,.95), rgba(17,26,51,.75)); padding:14px; overflow:auto; }

    .card { background: rgba(255,255,255,.03); border:1px solid var(--line); border-radius:14px; padding:12px; margin-bottom:12px; }
    .card h2 { margin:0 0 10px; font-size:14px; }
    label { display:block; font-size:12px; color:var(--muted); margin:10px 0 6px; }

    input[type="text"], input[type="date"], textarea, select, input[type="number"] {
      width:100%; padding:10px; border-radius:12px; border:1px solid var(--line);
      background: rgba(0,0,0,.25); color: var(--text); outline:none;
    }
    textarea { min-height: 90px; resize: vertical; }
    .row { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .btns { display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
    button {
      appearance:none; border:1px solid var(--line); background: rgba(106,166,255,.14);
      color: var(--text); padding:10px 10px; border-radius:12px; cursor:pointer; font-weight:700;
    }
    button.secondary { background: rgba(255,255,255,.06); }
    button.danger { background: rgba(255,90,90,.14); border-color: rgba(255,90,90,.35); }
    button:disabled { opacity:.55; cursor:not-allowed; }

    .hint { font-size:12px; color: var(--muted); line-height:1.35; }
    .list { display:flex; flex-direction:column; gap:8px; }
    .item {
      display:flex; justify-content:space-between; gap:10px;
      padding:10px; border-radius:12px; border:1px solid var(--line);
      background: rgba(0,0,0,.18);
    }
/* clignote uniquement la petite pastille rouge/verte */
.work-marker.blink-dot svg circle:nth-of-type(2) {
  animation: blinkDot 0.8s infinite;
}

@keyframes blinkDot {
  0%   { opacity: 1; }
  50%  { opacity: 0.25; }
  100% { opacity: 1; }
}


    .item b { font-size:13px; }
    .item small { color: var(--muted); display:block; margin-top:2px; }
    .item .actions { display:flex; gap:6px; align-items:flex-start; }
    .pill { font-size:11px; color: var(--muted); border:1px solid var(--line); padding:3px 8px; border-radius:999px; }

    .divider { height:1px; background: var(--line); margin:12px 0; opacity:.8; }

    .gallery { display:grid; grid-template-columns: repeat(2, 1fr); gap:8px; margin-top:10px; }
    .photo {
      border-radius:12px; border:1px solid var(--line); overflow:hidden; background: rgba(0,0,0,.2);
      display:flex; flex-direction:column;
    }
    .photo img { width:100%; height:140px; object-fit:cover; display:block; pointer-events:none; }
    .photo .meta { display:flex; justify-content:space-between; align-items:center; padding:8px; gap:8px; position:relative; z-index:5; }
    .photo .meta span { font-size:11px; color: var(--muted); }
    .photo .meta button { padding:6px 8px; border-radius:10px; font-size:12px; position:relative; z-index:6; }

    /* Carousel */
    .carousel { position:relative; width:100%; max-height:320px; margin-bottom:10px; text-align:center; }
    .carousel img { max-width:100%; max-height:320px; object-fit:contain; border-radius:12px; }
    .carousel-btn {
      position:absolute; top:50%; transform: translateY(-50%);
      background: rgba(0,0,0,0.5); border:none; color:white; font-size:22px;
      padding:6px 10px; cursor:pointer; border-radius:50%;
    }
    .carousel-btn.left { left:8px; }
    .carousel-btn.right { right:8px; }
    #carouselCount { font-size:12px; opacity:.7; margin-top:4px; }
    .hidden { display:none; }

    /* Marker icon fix */
    .work-marker.leaflet-div-icon { background:transparent !important; border:none !important; }

    /* Responsive */
    @media (max-width: 980px) {
      main { grid-template-columns: 1fr; height:auto; }
      #map { height: 55vh; }
      aside { height:auto; border-left:none; border-top:1px solid var(--line); }
    }

    /* Mode agent terrain (mobile/tablette) */
    body.agent-mode main { grid-template-columns: 1fr; }
    body.agent-mode #map { height: 100vh; }
    body.agent-mode aside {
      position: fixed; bottom: 0; left: 0; right: 0;
      height: 44vh; z-index: 1000;
      border-radius: 18px 18px 0 0;
      overflow-y:auto;
    }
    body.agent-mode button { font-size:16px; padding:14px; }
    .photo-status { margin-top: 6px; font-size: 0.9em; color: var(--muted); }

    /* Login overlay (optionnel si vous activez la synchro GAS) */
    #loginOverlay {
      position: fixed; inset: 0; background: rgba(5,10,25,0.92);
      z-index: 99999; display: none; align-items: center; justify-content: center;
    }
    #loginOverlay.show { display:flex; }
    .loginBox {
      background: #111a33; border: 1px solid var(--line); border-radius: 16px;
      padding: 24px; width: 320px; text-align: center;
    }
    .loginBox input {
      width:100%; padding:12px; margin:12px 0; border-radius:12px; border:1px solid var(--line);
      background: rgba(0,0,0,.3); color: var(--text);
    }
    #loginError { color: var(--danger); font-size: 13px; min-height: 18px; }
  
/* Blink uniquement si report.blink=true */
@keyframes pulseBlink {
  0%   { transform: scale(1); opacity: 1; }
  50%  { transform: scale(1.25); opacity: 0.25; }
  100% { transform: scale(1); opacity: 1; }
}
.marker-dot.blink {
  animation: pulseBlink 1s infinite;
  transform-origin: center;
}


.admin-actions{display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-left:auto;}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>

<body>

<div id="loginModal" style="position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:3000">
  <div style="background:#111a33;padding:18px;border-radius:14px;min-width:300px;border:1px solid #20305f">
    <h3 style="margin:0 0 10px 0;">Connexion</h3>
    <label>Profil</label>
    <select id="loginRole">
      <option value="admin">Administrateur</option>
      <option value="secteur">Responsable de secteur</option>
    </select>
    <label>Secteur</label>
    <select id="loginSecteur"></select>
    <label>Mot de passe</label>
    <input id="loginPassword" type="password" placeholder="Mot de passe">
    <button id="loginBtn">Se connecter</button>
    <button id="loginOfflineBtn" class="secondary" type="button" style="margin-top:6px;">Mode hors-ligne (d√©mo)</button>
    <div style="font-size:12px;opacity:.8;margin-top:8px;">
      * En production, les mots de passe sont v√©rifi√©s par Google Apps Script.
    </div>
  </div>
</div>


<header style="
display:flex;align-items:center;gap:12px;
padding:10px 14px;border-bottom:1px solid #20305f;
background:#0b1020;position:sticky;top:0;z-index:1000;">
  <img src="data:image/png;base64,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" alt="Ville de Marcq-en-Bar≈ìul" style="height:42px"/>
  <div>
    <div style="font-weight:700;font-size:16px;">Signalement de travaux</div>
    <div style="font-size:12px;opacity:.8;">Ville de Marcq-en-Bar≈ìul</div>
  

  <div id="topSectorTitle" style="position:absolute;left:50%;transform:translateX(-50%);font-weight:800;letter-spacing:.2px;opacity:.95;">‚Äî</div>
</div>

  <div style="margin-left:auto;display:flex;gap:8px;">
    <button id="historyBtn" class="secondary" type="button" style="width:auto;padding:8px 10px;">üßæ Historique</button>
    <button id="logoutBtn" class="secondary" type="button" style="width:auto;padding:8px 10px;">üîí D√©connexion</button>
    <button id="toggleArchivesBtn" class="secondary" type="button" style="width:auto;padding:8px 10px;display:none;">üóÑÔ∏è Archives</button>
    <div id="adminActions" class="admin-actions" style="display:none;"></div>
  </div>
</header>

<header class="app-header">
  <div style="display:flex;align-items:center;gap:12px;">
    <div>
      <h1>Signalement de travaux ‚Äî Marcq-en-Bar≈ìul</h1>
      <span class="badge">Clique sur la carte pour placer un marqueur</span>
    </div>
  </div>

  <button id="agentModeBtn" class="secondary">üì± Mode agent</button>
</header>

<main>
  <div id="map"></div>

  <aside>
    <!-- Aper√ßu -->
    <div class="card" id="previewCard" style="display:none;">
      <h2>Signalement</h2>

      <div id="photoCarousel" class="carousel hidden">
        <button class="carousel-btn left" type="button">‚¨ÖÔ∏è</button>
        <img id="carouselImage" alt="Photo du signalement" />
        <button class="carousel-btn right" type="button">‚û°Ô∏è</button>
        <div id="carouselCount"></div>
      </div>

      <div style="display:grid;gap:4px;">
        <p style="margin:4px 0;font-size:13px;"><b>ID :</b> <span id="p-id"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Secteur :</b> <span id="p-secteur"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Adresse :</b> <span id="p-address"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Date demande :</b> <span id="p-dateDemande"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Date ex√©cution :</b> <span id="p-dateExecution"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Nature :</b> <span id="p-nature"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Coordonn√©es :</b> <span id="p-coords"></span></p>
        <p style="margin:4px 0;font-size:13px;"><b>Commentaire :</b></p>
        <small id="p-comment" style="color:var(--muted);"></small>
      </div>

      <div class="btns" style="margin-top:12px;">
        <button class="secondary" id="openInNewTabBtn" type="button">Ouvrir la fiche</button>
<div class="btns" style="margin-top:8px;">
  <button class="secondary" id="mailBtn" type="button">üìß Envoyer par mail</button>
  <button class="secondary" id="printBtn" type="button">üñ®Ô∏è Imprimer</button>
  <button class="secondary" id="pdfBtn" type="button">üìÑ Exporter en PDF</button>
</div>

      </div>
    </div>

    <!-- Liste -->
    <div class="card">
      <div style="display:flex;align-items:center;justify-content:space-between;gap:8px;">
        <h2 style="margin:0;">Signalements</h2>
        <div style="display:flex;gap:6px;align-items:center;">
          <span id="count" class="pill">0</span>
          <button id="toggleListBtn" class="secondary" type="button">R√©duire</button>
        </div>
      </div>

      <div style="display:flex;gap:8px;margin-top:10px;">
        <input id="q" type="text" placeholder="Rechercher (secteur, adresse, nature‚Ä¶)" />
        <button class="secondary" id="exportBtn" type="button">Exporter</button>
      </div>

      <p class="hint" style="margin:10px 0 0;">
        Donn√©es stock√©es localement (localStorage). Optionnel : synchro Google Sheets (voir README).
      </p>

      <div class="divider"></div>

      <div id="listWrapper">
        <div id="reportList" class="list"></div>
      </div>

      <div class="btns">
        <button class="secondary" id="importBtn" type="button">Importer</button>
        <input id="importFile" type="file" accept="application/json" hidden />
      </div>
    </div>

    <!-- √âditeur -->
    <div class="card" id="editorCard">
      <h2 id="editorTitle">Ajouter un signalement</h2>
      <p class="hint" id="editorHint">Clique sur la carte pour choisir l‚Äôemplacement, puis compl√®te la fiche.</p>

      <label>Num√©ro de dossier</label>
<input id="dossierNumber" type="text" readonly style="opacity:.85;font-size:12px;" />

<label>ID</label>
      <input id="rid" type="text" readonly style="opacity:.75;font-size:12px;" />

      <label>Latitude / Longitude</label>
      <div class="row">
        <input id="lat" type="number" step="0.000001" placeholder="Latitude" />
        <input id="lng" type="number" step="0.000001" placeholder="Longitude" />
      </div>
      <div class="btns" style="margin-top:8px;">
        <button id="gpsBtn" class="secondary" type="button">üìç Utiliser ma position GPS</button>
        <button id="centerBtn" class="secondary" type="button">üß≠ Centrer sur le marqueur</button>
      </div>

      <label>Secteur</label>
      <select id="secteur">
        <option value="">‚Äî S√©lectionner ‚Äî</option>
        <option>Hautes Loges - Briqueterie</option>
        <option>Bourg</option>
        <option>Buisson - Delcencerie</option>
        <option>Mairie - Quesne</option>
        <option>Pont - Plouich - Cl√©menceau</option>
        <option>Cimeti√®re Delcencerie</option>
        <option>Cimeti√®re Pont</option>
        <option>Ferme aux Oies</option>
      </select>

      <label>Adresse</label>
      <input id="address" type="text" placeholder="Ex: Rue..., pr√®s de..." />

      <div class="row">
        <div>
          <label>Date de demande</label>
          <input id="dateDemande" type="date" />
        </div>
        <div>
          <label>Date d‚Äôex√©cution</label>
          <input id="dateExecution" type="date" />
        </div>
      </div>
      <div id="adminDateInterventionWrap" style="display:none;margin-top:10px;">
        <label>Date demande d‚Äôintervention (admin)</label>
        <input id="dateIntervention" type="date" />
      </div>


      <label>Type d‚Äôintervention</label>
<select id="interventionType">
  <option value="interne">Interne (services municipaux)</option>
  <option value="externe">Externe (entreprise)</option>
</select>

<label>Nature des travaux</label>
      <input id="nature" type="text" placeholder="Ex: rebouchage nid de poule, √©clairage, voirie‚Ä¶" />

      <label>Commentaire</label>
      <textarea id="comment" placeholder="D√©tails, urgence, observations‚Ä¶"></textarea>

      <div class="divider"></div>

      <h2 style="margin:0 0 10px;font-size:14px;">Photos</h2>

      <!-- Inputs invisibles -->
      <input id="cameraInput" type="file" accept="image/*" capture="environment" hidden />
      <input id="galleryInput" type="file" accept="image/*" multiple hidden />

      <div class="btns">
        <button id="takePhotoBtn" type="button">üì∏ Prendre une photo</button>
        <button id="pickGalleryBtn" class="secondary" type="button">üñºÔ∏è Galerie</button>
      </div>
      <div id="photoStatus" class="photo-status"></div>

      <div id="gallery" class="gallery"></div>

      <div class="divider"></div>

      <div class="btns">
        <button id="saveBtn" type="button">Enregistrer</button>
        <button id="newBtn" class="secondary" type="button">Nouveau</button>
        <button id="deleteBtn" class="danger" type="button" disabled>Supprimer</button>
        <button id="doneBtn" class="secondary" type="button" disabled>Travaux effectu√©</button>
      </div>

      <p class="hint" style="margin-top:10px;">
        Astuce : en mobile, active ‚ÄúMode agent‚Äù pour avoir la fiche en bas (comme l‚Äôappli Patrimoine arbor√©).
      </p>
    </div>
  </aside>
</main>

<!-- Login overlay (optionnel) -->
<div id="loginOverlay">
  <div class="loginBox">
    <h2 style="margin:0 0 10px;">Connexion</h2>
    <div class="hint">Si vous activez la synchro Google Sheets, entrez le mot de passe.</div>
    <input id="loginPwd" type="password" placeholder="Mot de passe" />
    <button id="loginBtn" type="button" style="width:100%;">Se connecter</button>
    <div id="loginError"></div>
    <button id="skipLoginBtn" class="secondary" type="button" style="width:100%;margin-top:8px;">Continuer sans synchro</button>
  </div>
</div>

<!-- Leaflet JS -->
<script
  src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
  crossorigin=""
></script>

<script src="app.js?v=v10reload"></script>
<script>
  // PWA (simple)
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => navigator.serviceWorker.register("./service-worker.js").catch(()=>{}));
  }
</script>

<div id="legend" style="
position:absolute;bottom:14px;left:14px;
background:#111a33;border:1px solid #20305f;
border-radius:14px;padding:10px 12px;
font-size:13px;z-index:999;">
  <div style="display:flex;align-items:center;justify-content:space-between;cursor:pointer"
       onclick="document.getElementById('legendBody').classList.toggle('hidden')">
    <b>Secteurs</b>
    <span>‚ñæ</span>
  </div>
  <div id="legendBody" style="margin-top:6px;">
    <div><span style="background:#1565C0" class="lg"></span> Hautes Loges - Briqueterie</div>
    <div><span style="background:#2E7D32" class="lg"></span> Bourg</div>
    <div><span style="background:#EF6C00" class="lg"></span> Buisson - Delcencerie</div>
    <div><span style="background:#6A1B9A" class="lg"></span> Mairie - Quesne</div>
    <div><span style="background:#00838F" class="lg"></span> Pont - Plouich - Cl√©menceau</div>
    <div><span style="background:#4E342E" class="lg"></span> Cimeti√®re Delcencerie</div>
    <div><span style="background:#C62828" class="lg"></span> Cimeti√®re Pont</div>
    <div><span style="background:#546E7A" class="lg"></span> Ferme aux Oies</div>
    <hr>
    <div><span style="background:#2E7D32" class="dot"></span> Interne</div>
    <div><span style="background:#D32F2F" class="dot"></span> Externe</div>
  </div>
</div>
<style>
#legend .lg{display:inline-block;width:12px;height:12px;border-radius:3px;margin-right:6px}
#legend .dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px}
.hidden{display:none}

/* Blink uniquement si report.blink=true */
@keyframes pulseBlink {
  0%   { transform: scale(1); opacity: 1; }
  50%  { transform: scale(1.25); opacity: 0.25; }
  100% { transform: scale(1); opacity: 1; }
}
.marker-dot.blink {
  animation: pulseBlink 1s infinite;
  transform-origin: center;
}

</style>


<div id="undoBar" style="
position:fixed;bottom:16px;left:50%;transform:translateX(-50%);
background:#20305f;color:white;padding:10px 16px;border-radius:12px;
display:flex;gap:12px;align-items:center;opacity:0;pointer-events:none;
transition:opacity .3s;">
  <span>Signalement supprim√©</span>
  <button onclick="undoDelete()" style="background:#ffeb3b;color:#000;border:none;padding:6px 10px;border-radius:8px;">ANNULER</button>
</div>
<style>
#undoBar.show{opacity:1;pointer-events:auto}

/* Blink uniquement si report.blink=true */
@keyframes pulseBlink {
  0%   { transform: scale(1); opacity: 1; }
  50%  { transform: scale(1.25); opacity: 0.25; }
  100% { transform: scale(1); opacity: 1; }
}
.marker-dot.blink {
  animation: pulseBlink 1s infinite;
  transform-origin: center;
}

</style>


<div id="adminPanel" style="display:none;position:fixed;top:70px;right:14px;z-index:2500;background:#111a33;border:1px solid #20305f;border-radius:14px;padding:10px;max-width:360px;max-height:55vh;overflow:auto;">
  <div style="display:flex;justify-content:space-between;align-items:center;">
    <b>Historique (admin)</b>
    <button id="closeAdminPanelBtn" class="secondary" type="button" style="width:auto;padding:6px 8px;">‚úï</button>
  </div>
  <div id="historyList" style="margin-top:8px;font-size:12px;white-space:pre-wrap;"></div>
</div>


  <div id="toast" style="position:fixed;bottom:18px;left:50%;transform:translateX(-50%);z-index:9999;display:none;min-width:260px;max-width:90vw;padding:12px 14px;border-radius:14px;background:rgba(10,15,25,.92);border:1px solid rgba(255,255,255,.14);box-shadow:0 12px 32px rgba(0,0,0,.35);color:#eaf1ff;font-weight:700;"></div>
</body>
</html>